<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Best steam deals</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>


    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>



</head>
<body>

<canvas id="chart" width="400" height="400"></canvas>


    <script>

        let xlabels_titles = ['Apex legends', 'Call of Duty', 'wallpaper engine', "Rocket League"];
        let dataSavings = [90,50,90,95,80];

        chartIt();

        async function chartIt() {

            // await loadData();

            const ctx = document.getElementById('chart');

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: xlabels_titles,
                    datasets: [{
                        label: 'best deals on steam, in %-savings',
                        data: dataSavings,
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }

            });
        }




        /*-----------------------------
        Here is the try to get load data do fetch data from the database, and load it into the two arrays namely:

        "xlabels_titles" and "dataSavings"

        -----------



async function loadData() {
  const mysql = require('mysql2/promise');

  const connection = await mysql.createConnection({
    host: 'localhost',
    user: 'root',
    password: 'AdminAdmin123',
    database: 'steamgames'
  });

  const [rows, fields] = await connection.execute('SELECT * FROM steamgames2 LIMIT 1');

  const data = Object.values(rows[0]);

  xlabels_titles.push(data[0]); // Assuming the first column contains the x-axis labels
  dataSavings.push(data[1]); // Assuming the second column contains the data values

  await connection.end();
}

---------------------------------------------------------

         */

        /*
        -------------------------
        This function was a copy paste, to try and get the method call
        ________________________


        function GetSteamDeals() {
    const mysql = require('mysql2');

    // create a connection to the MySQL database
    const connection = mysql.createConnection({
        host: 'localhost',
        user: 'root',
        password: 'AdminAdmin123',
        database: 'steamgames'

    });

    const clearSQL = 'TRUNCATE steamgames2'

    connection.query(clearSQL)
    // fetch data from the API
    fetch('https://www.cheapshark.com/api/1.0/deals?storeID=1&upperPrice=15')
        .then(response => response.json())
        .then(data => {
            // insert the data into the MySQL database
            data.forEach(item => {
                const sql = `INSERT INTO steamgames2 (title, salePrice, normalPrice, savings) VALUES (?, ?, ?, ?)`;
                const values = [item.title, item.salePrice, item.normalPrice, item.savings]
                //console.log(values[0]) //this should give the title
                //console.log(values[3]) //this should give the savings in %.
                //xlabels_titles.push(values[0]); //this should push the titles to the xlabels_titles array.
                //dataSavings.push(values[3]);    //this should then push the savings to the dataSavings array.
                connection.query(sql, values, (error, results, fields) => {
                    if (error) throw error;
                    console.log(`Inserted ${results.affectedRows} row(s)`);
                });
            });
        })
        .catch(error => console.error(error))
        .finally(() => {
            // close the MySQL connection when done
            connection.end();
        });


}
         */


</script>



</body>

